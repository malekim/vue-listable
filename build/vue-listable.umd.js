!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).VueListable=t()}(this,(function(){"use strict";var e={components:{Expander:{render:function(e){if(this.expanderSlot)return e("tr",{class:{"listable-tr":!0,"listable-tr-expander":!0}},[e("td",{class:["listable-td"],attrs:{colspan:this.colspan}},this.expanderSlot(this.row))])},props:{colspan:{type:Number,default:0},row:{type:Object,default:function(){}},expanderSlot:{type:Function,default:function(){}}}}},render:function(e){return e("div",{class:"listable-container",ref:"container"},[this.generateTable(e),this.generatePaginator(e)])},props:{headings:{type:Array,default:function(){return[]}},data:{type:Array,default:function(){return[]}},checkbox:{type:Boolean,default:!1},expandable:{type:Boolean,default:!1},responsive:{type:Boolean,default:!0}},data:function(){return{colspan:0,checked:[],expanded:[],searchable:!1,searched:{},resizeTimeout:null,responsiveMode:!1,responsiveMaxWidth:1/0}},mounted:function(){var e=this;this.$nextTick((function(){e.checkErrors(),e.searchable=e.isSearchable(),e.colspan=e.calculateColspan(),e.responsive&&window.addEventListener("resize",e.handleResponsive)}))},methods:{calculateColspan:function(){var e=this.headings.length;return this.checkbox&&(e+=1),e},checkErrors:function(){this.data.length>0&&this.headings.length!==this.data[0].length&&console.error("Header's row length ("+this.headings.length+") and body's row length ("+this.data[0].length+") are not equal.")},generateTable:function(e){var t=this.generateHeader(e),n=this.generateBody(e);return e("table",{class:{listable:!0,"responsive-mode":this.responsiveMode},ref:"table"},[t,n])},generateHeader:function(e){return e("thead",{class:"listable-header"},this.generateHeaderRows(e))},generateHeaderRows:function(e){var t=[];return t.push(e("tr",{class:{"listable-tr":!0,"listable-tr-checked":this.checked.length>0&&this.checked.length===this.data.length}},[this.generateHeaderCells(e,!1)])),this.searchable&&t.push(e("tr",{class:{"listable-tr":!0,"listable-tr-search":!0}},[this.generateHeaderCells(e,!0)])),t},isSearchable:function(){for(var e in this.headings)if(this.headings[e].search)return!0;return!1},generateHeaderCells:function(e,t){var n=this,s=[];this.checkbox&&s.push(e("th",{class:{"listable-th":!0,"listable-th-checkbox":!0}},[t?null:e("span",{class:{"listable-checkbox":!0},on:{click:n.handleAllCheckbox}})]));var a=function(a){var i=null;if(t&&n.headings[a].search){var r=null;i=e("input",{class:"listable-search",on:{input:function(e){clearTimeout(r),r=setTimeout((function(){n.$emit("input",e.target.value),n.searched[n.headings[a].column]=e.target.value,n.$emit("search",n.searched)}),500)}}})}var l=null;t||(l=n.headings[a].display),s.push(e("th",{class:"listable-th"},[l,i]))};for(var i in n.headings)a(i);return s},generateBody:function(e){return e("tbody",{class:"listable-body"},this.generateBodyRows(e))},handleCheckbox:function(e,t){e.stopPropagation();var n=this.checked.indexOf(t);-1!==n?this.checked.splice(n,1):this.checked.push(t),this.$emit("checked",this.checked)},handleAllCheckbox:function(e){if(e.stopPropagation(),this.checked.length>0)this.checked=[];else for(var t in this.checked=[],this.data)this.checked.push(t);this.$emit("checked",this.checked)},generateBodyRows:function(e){var t=this,n=[],s=function(s){t.responsiveMode&&n.push(e("tr",{class:{"listable-tr-checkbox":!0,"listable-tr-checked":-1!==t.checked.indexOf(s)}},[e("td",{class:{"listable-checkbox":!0},on:{click:function(e){return t.handleCheckbox(e,s)}}})]));var a="tr_"+s;n.push(e("tr",{class:{"listable-tr":!0,"listable-tr-checked":-1!==t.checked.indexOf(s)},on:{click:function(e){if(e.stopPropagation(),t.expandable){var n=t.expanded.indexOf(s);-1!==n?t.expanded.splice(n,1):t.expanded.push(s),t.$emit("expanded",t.expanded)}}},ref:a},t.generateBodyRowCells(e,s,t.data[s]))),t.expandable&&-1!==t.expanded.indexOf(s)&&n.push(t.generateExpander(e,t.data[s]))};for(var a in t.data)s(a);return n},generateBodyRowCells:function(e,t,n){var s=this,a=[];this.checkbox&&a.push(e("td",{class:"listable-td listable-td-checkbox"},[e("td",{class:"listable-checkbox",on:{click:function(e){return s.handleCheckbox(e,t)}}})]));var i=function(i){var r=s.headings[i].column,l=null,o="td_"+t+"_"+i,c=null;if(s.responsiveMode&&(c=e("div",{class:["listable-td-th"]},s.headings[i].display)),s.$scopedSlots[r]){var d=s.$scopedSlots[r](n);l=e("td",{class:["listable-td"],style:[],ref:o},[c,d])}else l=e("td",{class:["listable-td"],style:[],ref:o},[c,void 0===n[r]||null===n[r]?"":n[r].constructor===Array?"":n[r].constructor===Object?"":n[r]]);a.push(l),s.$nextTick((function(){s.$emit("hook",s.$refs[o],r,n)}))};for(var r in s.headings)i(r);return a},generateExpander:function(e,t){if(this.$scopedSlots.expander)return e("Expander",{props:{colspan:this.colspan,expanderSlot:this.$scopedSlots.expander,row:t}})},generatePaginator:function(e){return this.$slots.paginator?e("div",{class:"listable-paginator"},this.$slots.paginator):null},handleResponsive:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout((function(){var t=window.innerWidth,n=e.$refs.container.clientWidth,s=e.$refs.table.clientWidth;t>e.responsiveMaxWidth&&(e.responsiveMode=!1),s>n&&(e.responsiveMaxWidth=t,e.responsiveMode=!0)}),100)}},updated:function(){var e=this;this.$nextTick((function(){e.handleResponsive()}))},beforeDestroy:function(){this.responsive&&window.removeEventListener("resize",this.handleResponsive)}};return{install:function(t,n){t.component("listable",e)}}}));
